suricata -> signature-based
1. C2 IoC
- IP/domain
- X.509 certi hash
- JA3/JA3S hash

2. live update (threat hunting)
- User-Agent
- URI pattern
- common protocol on uncommon port

zeek -> behavioral-based
- periodicity (connection interval, jitter)
- payload size
- Domain Generation Algorithms
- self-signed certificate, short expiry time
- connection duration


ELK
- collect log from suricata, zeek (filebeat)
- calculate analyse metrics, suspicious score (logstash - realtime, python - batch)
- store for query (elasticsearch)
- visualize (kibana)

cmd
capinfos
zeek-cut -d
rita import --database=taidoor --logs=/home/mbelin/vdt/c2-beacon-detection/traffic/log/taidoor
/opt/zeek/bin/zeek -r ~/vdt/c2-beacon-detection/traffic/real/cobaltstrike_taidoor_24hr.pcap




----
installed C2 framework:
sliver
mythic
havoc
empire


topo:
kali (C2) - NAT8 -> 192.168.145.129
ubuntu (NSM) - host -> 192.168.28.1
windows (victim) - NAT9
debian (victim) - NAT9 -> 192.168.28.129

zeek log: /opt/zeek/logs/current
zeek binary: /opt/zeek/bin/zeek
